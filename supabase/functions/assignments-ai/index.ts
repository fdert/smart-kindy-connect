import { serve } from "https://deno.land/std@0.168.0/http/server.ts"
import { createClient } from 'https://esm.sh/@supabase/supabase-js@2'

const corsHeaders = {
  'Access-Control-Allow-Origin': '*',
  'Access-Control-Allow-Headers': 'authorization, x-client-info, apikey, content-type',
}

interface AnalyzeNoteRequest {
  noteContent: string;
  noteType: string;
  studentAge?: number;
}

interface GenerateAssignmentRequest {
  subject: string;
  grade: string;
  topic: string;
  difficulty: string;
}

// ØªØ­Ø³ÙŠÙ† ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù†Ø§Ù‡Ø¬ Ø±ÙŠØ§Ø¶ Ø§Ù„Ø£Ø·ÙØ§Ù„ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©
function analyzeNote(content: string, type: string, studentAge?: number): { analysis: string; suggestions: string } {
  const ageGroup = studentAge ? (studentAge <= 4 ? 'ØµØºÙŠØ±' : studentAge <= 5 ? 'Ù…ØªÙˆØ³Ø·' : 'ÙƒØ¨ÙŠØ±') : 'Ù…ØªÙˆØ³Ø·';
  
  const keywords = {
    academic: {
      positive: ['Ù…ØªÙ…ÙŠØ²', 'Ù…Ù…ØªØ§Ø²', 'ØªÙ‚Ø¯Ù…', 'Ù†Ø¬Ø­', 'Ø£ØªÙ‚Ù†', 'ØªØ­Ø³Ù†', 'Ù…Ø¨Ø¯Ø¹', 'Ù…ØªÙÙˆÙ‚'],
      negative: ['ØµØ¹ÙˆØ¨Ø©', 'Ø¶Ø¹Ù', 'Ù„Ù… ÙŠØªÙ‚Ù†', 'ÙŠØ­ØªØ§Ø¬ Ù…Ø³Ø§Ø¹Ø¯Ø©', 'Ù…ØªØ£Ø®Ø±', 'Ù„Ù… ÙŠÙÙ‡Ù…'],
      neutral: ['ÙŠØªØ¹Ù„Ù…', 'ÙÙŠ ØªØ·ÙˆØ±', 'ÙŠØ­Ø§ÙˆÙ„', 'ÙŠØ´Ø§Ø±Ùƒ']
    },
    behavioral: {
      positive: ['Ù…Ø¤Ø¯Ø¨', 'Ù…Ù†Ø¶Ø¨Ø·', 'Ù…ØªØ¹Ø§ÙˆÙ†', 'Ù‡Ø§Ø¯Ø¦', 'Ù…Ø­ØªØ±Ù…', 'ÙŠØ³Ø§Ø¹Ø¯ Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†'],
      negative: ['Ø¹Ø¯ÙˆØ§Ù†ÙŠ', 'Ù…Ø´Ø§ØºØ¨', 'Ù„Ø§ ÙŠØ³ØªÙ…Ø¹', 'ÙŠØ¶Ø±Ø¨', 'ÙŠØµØ±Ø®', 'Ù„Ø§ ÙŠØ·ÙŠØ¹'],
      neutral: ['Ù†Ø´ÙŠØ·', 'Ø­ÙŠÙˆÙŠ', 'ÙŠØ­ØªØ§Ø¬ ØªÙˆØ¬ÙŠÙ‡']
    },
    social: {
      positive: ['Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ', 'ÙŠØªÙØ§Ø¹Ù„', 'Ù„Ù‡ Ø£ØµØ¯Ù‚Ø§Ø¡', 'ÙŠØ´Ø§Ø±Ùƒ', 'Ù…ØªØ¹Ø§ÙˆÙ†'],
      negative: ['Ø®Ø¬ÙˆÙ„', 'Ù…Ù†Ø·ÙˆÙŠ', 'Ù„Ø§ ÙŠØªÙØ§Ø¹Ù„', 'ÙˆØ­ÙŠØ¯', 'ÙŠØªØ¬Ù†Ø¨ Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†'],
      neutral: ['ÙŠØ±Ø§Ù‚Ø¨', 'ÙŠØªØ¹Ù„Ù… Ø§Ù„ØªÙØ§Ø¹Ù„', 'Ø¨Ø­Ø§Ø¬Ø© ØªØ´Ø¬ÙŠØ¹']
    },
    health: {
      positive: ['ØµØ­ÙŠ', 'Ù†Ø´ÙŠØ·', 'Ù‚ÙˆÙŠ Ø§Ù„Ø¨Ù†ÙŠØ©', 'Ø¬ÙŠØ¯ Ø§Ù„Ø´Ù‡ÙŠØ©'],
      negative: ['Ù…Ø±ÙŠØ¶', 'Ø¶Ø¹ÙŠÙ', 'Ù…ØªØ¹Ø¨', 'Ù„Ø§ ÙŠØ£ÙƒÙ„', 'Ø´Ø§Ø­Ø¨'],
      neutral: ['ÙŠØ­ØªØ§Ø¬ Ù…ØªØ§Ø¨Ø¹Ø©', 'ØªØ­Øª Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©']
    }
  };

  const typeKeywords = keywords[type as keyof typeof keywords] || { positive: [], negative: [], neutral: [] };
  const positiveFound = typeKeywords.positive.filter(keyword => content.includes(keyword));
  const negativeFound = typeKeywords.negative.filter(keyword => content.includes(keyword));
  const neutralFound = typeKeywords.neutral.filter(keyword => content.includes(keyword));

  let analysis = '';
  let suggestions = '';

  if (type === 'academic') {
    if (negativeFound.length > 0) {
      analysis = `Ø§Ù„Ø·Ø§Ù„Ø¨ ÙŠÙˆØ§Ø¬Ù‡ ØªØ­Ø¯ÙŠØ§Øª Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© ØªØªØ·Ù„Ø¨ ØªØ¯Ø®Ù„ ØªØ¹Ù„ÙŠÙ…ÙŠ Ù…Ù†Ø§Ø³Ø¨ Ù„Ø¹Ù…Ø± ${ageGroup} ÙÙŠ Ø±ÙŠØ§Ø¶ Ø§Ù„Ø£Ø·ÙØ§Ù„. `;
      if (ageGroup === 'ØµØºÙŠØ±') {
        analysis += 'ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù…Ø±ØŒ Ø§Ù„ØªØ¹Ù„Ù… ÙŠØªÙ… Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„Ù„Ø¹Ø¨ ÙˆØ§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø­Ø³ÙŠØ©.';
        suggestions = `Ø­Ù„ÙˆÙ„ Ù…Ù‚ØªØ±Ø­Ø© Ù„Ø·ÙÙ„ ${ageGroup}:
â€¢ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© ÙˆØ§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø­Ø±ÙƒÙŠØ©
â€¢ ØªØ¹Ù„Ù… Ø§Ù„Ø­Ø±ÙˆÙ ÙˆØ§Ù„Ø£Ø±Ù‚Ø§Ù… Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„Ø£ØºØ§Ù†ÙŠ ÙˆØ§Ù„Ù‚ØµØµ
â€¢ Ø£Ù†Ø´Ø·Ø© ÙÙ†ÙŠØ© Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø­Ø±ÙƒÙŠØ© Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø©
â€¢ ÙˆÙ‚Øª Ø¥Ø¶Ø§ÙÙŠ Ù„Ù„ØªÙƒØ±Ø§Ø± ÙˆØ§Ù„Ù…Ù…Ø§Ø±Ø³Ø© Ø¨Ø·Ø±ÙŠÙ‚Ø© Ù…Ù…ØªØ¹Ø©
â€¢ ØªØ¹Ø²ÙŠØ² Ø¥ÙŠØ¬Ø§Ø¨ÙŠ ÙÙˆØ±ÙŠ Ø¹Ù†Ø¯ Ø£ÙŠ ØªÙ‚Ø¯Ù…
â€¢ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø£Ù‡Ù„ Ù„ØªØ·Ø¨ÙŠÙ‚ Ù†ÙØ³ Ø§Ù„Ø£Ù†Ø´Ø·Ø© ÙÙŠ Ø§Ù„Ù…Ù†Ø²Ù„`;
      } else if (ageGroup === 'Ù…ØªÙˆØ³Ø·') {
        analysis += 'ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù…Ø±ØŒ ÙŠÙ…ÙƒÙ† Ø¯Ù…Ø¬ Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„Ù‡Ø§Ø¯Ù Ù…Ø¹ Ø§Ù„Ù„Ø¹Ø¨.';
        suggestions = `Ø­Ù„ÙˆÙ„ Ù…Ù‚ØªØ±Ø­Ø© Ù„Ø·ÙÙ„ ${ageGroup}:
â€¢ Ø£Ù†Ø´Ø·Ø© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ù…Ù†Ø¸Ù…Ø© Ù…Ø¹ Ø¹Ù†ØµØ± Ø§Ù„Ù„Ø¹Ø¨
â€¢ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù‚ØµØµ Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ù…ÙØ§Ù‡ÙŠÙ…
â€¢ Ø£Ù†Ø´Ø·Ø© Ø¬Ù…Ø§Ø¹ÙŠØ© ØµØºÙŠØ±Ø© Ù„ØªØ´Ø¬ÙŠØ¹ Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„ØªØ´Ø§Ø±ÙƒÙŠ
â€¢ Ø¬Ù„Ø³Ø§Øª Ù‚Ø±Ø§Ø¡Ø© ÙŠÙˆÙ…ÙŠØ© Ù…Ø¹ Ø§Ù„ØµÙˆØ±
â€¢ Ø£Ù„Ø¹Ø§Ø¨ Ø±ÙŠØ§Ø¶ÙŠØ© Ù…Ù†ØªØ¸Ù…Ø© Ù…Ø¹ Ø§Ù„Ù…ÙØ§Ù‡ÙŠÙ… Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©
â€¢ Ø¨Ø±Ù†Ø§Ù…Ø¬ ØªØ¹Ø²ÙŠØ² Ø³Ù„ÙˆÙƒÙŠ Ø¨Ø§Ù„Ù†Ø¬ÙˆÙ… ÙˆØ§Ù„Ù…ÙƒØ§ÙØ¢Øª`;
      } else {
        analysis += 'ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù…Ø±ØŒ Ø§Ù„Ø·ÙÙ„ Ù…Ø³ØªØ¹Ø¯ Ù„Ø£Ù†Ø´Ø·Ø© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø£ÙƒØ«Ø± ØªÙ†Ø¸ÙŠÙ…Ø§Ù‹.';
        suggestions = `Ø­Ù„ÙˆÙ„ Ù…Ù‚ØªØ±Ø­Ø© Ù„Ø·ÙÙ„ ${ageGroup}:
â€¢ Ø£Ù†Ø´Ø·Ø© ØªØ­Ø¶ÙŠØ±ÙŠØ© Ù„Ù„Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ©
â€¢ ØªØ·ÙˆÙŠØ± Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„ÙƒØªØ§Ø¨Ø© ÙˆØ§Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ø¨ÙƒØ±Ø©
â€¢ Ø£Ù†Ø´Ø·Ø© Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø§Øª Ø§Ù„Ø¨Ø³ÙŠØ·Ø©
â€¢ Ù…Ø´Ø§Ø±ÙŠØ¹ ÙÙ†ÙŠØ© ÙˆØ¹Ù„Ù…ÙŠØ© ØµØºÙŠØ±Ø©
â€¢ ØªØ¹Ù„Ù… Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ø³Ù„ÙˆÙƒ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ
â€¢ ØªÙ‚ÙŠÙŠÙ… Ù…Ø³ØªÙ…Ø± Ù…Ø¹ Ø§Ù„ØªØºØ°ÙŠØ© Ø§Ù„Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ©`;
      }
    } else if (positiveFound.length > 0) {
      analysis = `Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…ØªÙ…ÙŠØ² ÙˆÙŠÙØ¸Ù‡Ø± Ø§Ø³ØªØ¹Ø¯Ø§Ø¯Ø§Ù‹ Ø¬ÙŠØ¯Ø§Ù‹ Ù„Ù„ØªØ·ÙˆØ± ÙÙŠ Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¹Ù…Ø±ÙŠØ© ${ageGroup}.`;
      suggestions = `Ø®Ø·Ø© ØªØ·ÙˆÙŠØ±ÙŠØ© Ù„Ø·ÙÙ„ Ù…ØªÙ…ÙŠØ² ${ageGroup}:
â€¢ Ø£Ù†Ø´Ø·Ø© Ø¥Ø«Ø±Ø§Ø¦ÙŠØ© ØªØ­Ø¯ÙŠ Ù‚Ø¯Ø±Ø§ØªÙ‡
â€¢ Ø¯ÙˆØ± Ù‚ÙŠØ§Ø¯ÙŠ ÙÙŠ Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ©
â€¢ Ù…Ø´Ø§Ø±ÙŠØ¹ Ø¥Ø¨Ø¯Ø§Ø¹ÙŠØ© Ù…ØªÙ‚Ø¯Ù…Ø©
â€¢ Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ø£Ø·ÙØ§Ù„ Ø§Ù„Ø¢Ø®Ø±ÙŠÙ† (Ø§Ù„ØªØ¹Ù„Ù… Ø¨Ø§Ù„ØªØ¹Ù„ÙŠÙ…)
â€¢ ØªØ·ÙˆÙŠØ± Ù…ÙˆØ§Ù‡Ø¨ Ø®Ø§ØµØ© (ÙÙ†ØŒ Ù…ÙˆØ³ÙŠÙ‚Ù‰ØŒ Ø±ÙŠØ§Ø¶Ø©)
â€¢ Ø¥Ø¹Ø¯Ø§Ø¯ Ù„Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ© Ø¨Ø£Ù†Ø´Ø·Ø© Ù…ØªÙ‚Ø¯Ù…Ø©`;
    } else {
      analysis = `Ø§Ù„Ø·Ø§Ù„Ø¨ ÙÙŠ Ù…Ø±Ø­Ù„Ø© ØªØ·ÙˆÙŠØ± Ø·Ø¨ÙŠØ¹ÙŠØ© Ù„Ø¹Ù…Ø± ${ageGroup} ÙˆÙŠØ­ØªØ§Ø¬ Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ù…Ø³ØªÙ…Ø±Ø©.`;
      suggestions = `Ø¨Ø±Ù†Ø§Ù…Ø¬ ØªØ·ÙˆÙŠØ± Ø´Ø§Ù…Ù„ Ù„Ø·ÙÙ„ ${ageGroup}:
â€¢ ØªÙ‚ÙŠÙŠÙ… Ø¯ÙˆØ±ÙŠ Ù„Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
â€¢ Ø£Ù†Ø´Ø·Ø© Ù…ØªÙ†ÙˆØ¹Ø© ØªÙ†Ø§Ø³Ø¨ Ù†Ù…Ø· ØªØ¹Ù„Ù…Ù‡
â€¢ ØªØ¹Ø²ÙŠØ² Ø§Ù„Ø«Ù‚Ø© Ø¨Ø§Ù„Ù†ÙØ³ Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø©
â€¢ Ø¯Ù…Ø¬ Ø§Ù„Ù„Ø¹Ø¨ ÙˆØ§Ù„ØªØ¹Ù„Ù… Ø¨Ø·Ø±ÙŠÙ‚Ø© Ù…ØªÙˆØ§Ø²Ù†Ø©
â€¢ Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ù…Ù†ØªØ¸Ù… Ù…Ø¹ Ø§Ù„Ø£Ù‡Ù„`;
    }
  } else if (type === 'behavioral') {
    if (negativeFound.length > 0) {
      analysis = `ÙŠÙˆØ§Ø¬Ù‡ Ø§Ù„Ø·Ø§Ù„Ø¨ ØªØ­Ø¯ÙŠØ§Øª Ø³Ù„ÙˆÙƒÙŠØ© ØªØ­ØªØ§Ø¬ Ù„ØªØ¯Ø®Ù„ ØªØ±Ø¨ÙˆÙŠ Ù…Ù†Ø§Ø³Ø¨ Ù„Ø·ÙÙ„ ${ageGroup}.`;
      suggestions = `Ø®Ø·Ø© ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø³Ù„ÙˆÙƒ Ù„Ø·ÙÙ„ ${ageGroup}:
â€¢ ÙˆØ¶Ø¹ Ù‚ÙˆØ§Ù†ÙŠÙ† ÙˆØ§Ø¶Ø­Ø© ÙˆØ¨Ø³ÙŠØ·Ø© Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ù„Ø¹Ù…Ø±
â€¢ Ù†Ø¸Ø§Ù… ØªØ¹Ø²ÙŠØ² Ø¥ÙŠØ¬Ø§Ø¨ÙŠ ÙÙˆØ±ÙŠ (Ù…Ù„ØµÙ‚Ø§ØªØŒ Ù…ÙƒØ§ÙØ¢Øª ØµØºÙŠØ±Ø©)
â€¢ ØªØ¹Ù„ÙŠÙ… Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ØºØ¶Ø¨ Ø¨Ø·Ø±Ù‚ Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ù„Ø£Ø·ÙØ§Ù„
â€¢ Ø£Ù†Ø´Ø·Ø© ØªÙØ±ÙŠØº Ø§Ù„Ø·Ø§Ù‚Ø© (Ø£Ù„Ø¹Ø§Ø¨ Ø­Ø±ÙƒÙŠØ©ØŒ Ø±ÙŠØ§Ø¶Ø©)
â€¢ ØªØ¹Ù„Ù… Ø§Ù„ØªØ¹Ø¨ÙŠØ± Ø¹Ù† Ø§Ù„Ù…Ø´Ø§Ø¹Ø± Ø¨Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ø³Ù„ÙˆÙƒ
â€¢ Ø¬Ù„Ø³Ø§Øª Ø¥Ø±Ø´Ø§Ø¯ÙŠØ© Ù…Ø¹ Ø§Ù„Ù…Ø®ØªØµ Ø§Ù„Ù†ÙØ³ÙŠ
â€¢ Ø¨Ø±Ù†Ø§Ù…Ø¬ ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ø£Ù‡Ù„ Ø¹Ù„Ù‰ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø³Ù„ÙˆÙƒ
â€¢ Ù‚ØµØµ ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø¹Ù† Ø§Ù„Ø³Ù„ÙˆÙƒ Ø§Ù„Ù…Ø±ØºÙˆØ¨`;
    } else if (positiveFound.length > 0) {
      analysis = `Ø³Ù„ÙˆÙƒ Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¥ÙŠØ¬Ø§Ø¨ÙŠ ÙˆÙ…Ù†Ø§Ø³Ø¨ Ù„Ø¹Ù…Ø± ${ageGroup}.`;
      suggestions = `ØªØ¹Ø²ÙŠØ² Ø§Ù„Ø³Ù„ÙˆÙƒ Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠ:
â€¢ Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± ÙÙŠ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ¹Ø²ÙŠØ² Ø§Ù„Ø­Ø§Ù„ÙŠ
â€¢ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø·ÙÙ„ ÙƒÙ‚Ø¯ÙˆØ© Ù„Ù„Ø¢Ø®Ø±ÙŠÙ†
â€¢ Ø¥Ø¹Ø·Ø§Ø¡ Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª ØµØºÙŠØ±Ø© Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ù„Ø¹Ù…Ø±
â€¢ Ù…Ø¯Ø­ Ø§Ù„Ø³Ù„ÙˆÙƒ Ø£Ù…Ø§Ù… Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†
â€¢ ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ù‚ÙŠØ§Ø¯ÙŠØ©`;
    } else {
      analysis = `Ø§Ù„Ø³Ù„ÙˆÙƒ Ø§Ù„Ø¹Ø§Ù… ÙŠØ­ØªØ§Ø¬ ØªÙˆØ¬ÙŠÙ‡ ÙˆØªØ·ÙˆÙŠØ± Ù…Ù†Ø§Ø³Ø¨ Ù„Ø¹Ù…Ø± ${ageGroup}.`;
      suggestions = `Ø¨Ø±Ù†Ø§Ù…Ø¬ ØªØ·ÙˆÙŠØ± Ø§Ù„Ø³Ù„ÙˆÙƒ:
â€¢ ÙˆØ¶Ø¹ Ø±ÙˆØªÙŠÙ† ÙŠÙˆÙ…ÙŠ ÙˆØ§Ø¶Ø­
â€¢ ØªØ¹Ù„ÙŠÙ… Ø¢Ø¯Ø§Ø¨ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†
â€¢ Ø£Ù†Ø´Ø·Ø© ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©
â€¢ Ù„Ø¹Ø¨ Ø§Ù„Ø£Ø¯ÙˆØ§Ø± Ù„ØªØ¹Ù„Ù… Ø§Ù„Ø³Ù„ÙˆÙƒ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨
â€¢ Ù‚ØµØµ ØªØ±Ø¨ÙˆÙŠØ© Ù‡Ø§Ø¯ÙØ©`;
    }
  } else if (type === 'social') {
    if (negativeFound.length > 0) {
      analysis = `ÙŠØ­ØªØ§Ø¬ Ø§Ù„Ø·Ø§Ù„Ø¨ Ù„Ø¯Ø¹Ù… ÙÙŠ ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ø¹Ù…Ø± ${ageGroup}.`;
      suggestions = `Ø¨Ø±Ù†Ø§Ù…Ø¬ ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©:
â€¢ Ø£Ù†Ø´Ø·Ø© Ø¬Ù…Ø§Ø¹ÙŠØ© ØµØºÙŠØ±Ø© (2-3 Ø£Ø·ÙØ§Ù„)
â€¢ Ø£Ù„Ø¹Ø§Ø¨ ØªØ´Ø§Ø±ÙƒÙŠØ© ØªØ´Ø¬Ø¹ Ø§Ù„ØªÙØ§Ø¹Ù„
â€¢ ØªØ¹Ù„Ù… ÙƒÙ„Ù…Ø§Øª Ø§Ù„ØªØ­ÙŠØ© ÙˆØ§Ù„Ø´ÙƒØ± ÙˆØ§Ù„Ø§Ø¹ØªØ°Ø§Ø±
â€¢ Ù‚ØµØµ Ø¹Ù† Ø§Ù„ØµØ¯Ø§Ù‚Ø© ÙˆØ§Ù„ØªØ¹Ø§ÙˆÙ†
â€¢ ØªØ¯Ø±ÙŠØ¨ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„Ù„Ø¹Ø¨
â€¢ Ø¯Ø¹ÙˆØ© Ø£Ø·ÙØ§Ù„ Ø¢Ø®Ø±ÙŠÙ† Ù„Ù„Ø¹Ø¨ Ù…Ø¹Ù‡
â€¢ ØªØ¹Ø²ÙŠØ² Ø£ÙŠ Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ù„ØªÙØ§Ø¹Ù„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ`;
    } else if (positiveFound.length > 0) {
      analysis = `Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø·ÙÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ© Ø¬ÙŠØ¯Ø© ÙˆÙ…Ù†Ø§Ø³Ø¨Ø© Ù„Ø¹Ù…Ø± ${ageGroup}.`;
      suggestions = `ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©:
â€¢ Ø¯ÙˆØ± Ù‚ÙŠØ§Ø¯ÙŠ ÙÙŠ Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ©
â€¢ ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø¢Ø®Ø±ÙŠÙ† Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©
â€¢ Ù…Ø´Ø§Ø±ÙŠØ¹ ØªØ¹Ø§ÙˆÙ†ÙŠØ©
â€¢ ØªØ·ÙˆÙŠØ± Ù…Ù‡Ø§Ø±Ø§Øª Ø­Ù„ Ø§Ù„Ù†Ø²Ø§Ø¹Ø§Øª
â€¢ Ø£Ù†Ø´Ø·Ø© Ø®Ø¯Ù…Ø© Ø§Ù„Ù…Ø¬ØªÙ…Ø¹ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ù„Ø¹Ù…Ø±`;
    } else {
      analysis = `Ø§Ù„ØªØ·ÙˆØ± Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ Ø·Ø¨ÙŠØ¹ÙŠ Ù„Ø¹Ù…Ø± ${ageGroup} Ù…Ø¹ Ø§Ù„Ø­Ø§Ø¬Ø© Ù„Ù„ØªØ´Ø¬ÙŠØ¹.`;
      suggestions = `Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ:
â€¢ ØªØ´Ø¬ÙŠØ¹ Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø© ÙÙŠ Ø§Ù„ØªÙØ§Ø¹Ù„
â€¢ Ø£Ù†Ø´Ø·Ø© ØªØ±ÙÙŠÙ‡ÙŠØ© Ø¬Ù…Ø§Ø¹ÙŠØ©
â€¢ ØªØ¹Ù„Ù… Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹
â€¢ Ø§Ù„Ø¹Ø§Ø¨ Ø§Ù„Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©
â€¢ Ø§Ø­ØªÙØ§Ù„Ø§Øª Ø¬Ù…Ø§Ø¹ÙŠØ© ÙˆØ£Ù†Ø´Ø·Ø© Ø®Ø§ØµØ©`;
    }
  } else if (type === 'health') {
    analysis = `Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„ØµØ­ÙŠØ© Ù„Ù„Ø·Ø§Ù„Ø¨ ØªØªØ·Ù„Ø¨ Ù…ØªØ§Ø¨Ø¹Ø© Ø®Ø§ØµØ© Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ø¹Ù…Ø± ${ageGroup}.`;
    if (negativeFound.length > 0) {
      suggestions = `Ø®Ø·Ø© Ø§Ù„Ø±Ø¹Ø§ÙŠØ© Ø§Ù„ØµØ­ÙŠØ©:
â€¢ Ø§Ø³ØªØ´Ø§Ø±Ø© Ø·Ø¨ÙŠØ© Ø¹Ø§Ø¬Ù„Ø©
â€¢ Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ù…Ø³ØªÙ…Ø± Ù…Ø¹ Ø§Ù„Ø£Ù‡Ù„
â€¢ Ù…Ø±Ø§Ù‚Ø¨Ø© ÙŠÙˆÙ…ÙŠØ© Ù„Ù„Ø­Ø§Ù„Ø© Ø§Ù„ØµØ­ÙŠØ©
â€¢ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„ØµØ­ÙŠØ©
â€¢ ØªÙˆÙÙŠØ± Ø¨ÙŠØ¦Ø© ØµØ­ÙŠØ© Ø¢Ù…Ù†Ø©
â€¢ Ø¨Ø±Ù†Ø§Ù…Ø¬ ØºØ°Ø§Ø¦ÙŠ Ø®Ø§Øµ Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±
â€¢ Ù…ØªØ§Ø¨Ø¹Ø© Ù…Ø¹ Ø§Ù„Ù…Ù…Ø±Ø¶Ø© Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ©`;
    } else {
      suggestions = `Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØµØ­Ø© Ø§Ù„ÙˆÙ‚Ø§Ø¦ÙŠØ©:
â€¢ ÙØ­ÙˆØµØ§Øª Ø¯ÙˆØ±ÙŠØ© Ù…Ù†ØªØ¸Ù…Ø©
â€¢ ØªØ¹Ø²ÙŠØ² Ø§Ù„Ø¹Ø§Ø¯Ø§Øª Ø§Ù„ØµØ­ÙŠØ©
â€¢ Ø£Ù†Ø´Ø·Ø© Ø±ÙŠØ§Ø¶ÙŠØ© Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ù„Ø¹Ù…Ø±
â€¢ ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ù†Ø¸Ø§ÙØ© Ø§Ù„Ø´Ø®ØµÙŠØ©
â€¢ Ø¨Ø±Ù†Ø§Ù…Ø¬ ØºØ°Ø§Ø¦ÙŠ Ù…ØªÙˆØ§Ø²Ù†
â€¢ ØªØ«Ù‚ÙŠÙ ØµØ­ÙŠ Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„Ø·ÙÙ„`;
    }
  }

  return { analysis, suggestions };
}

// ØªØ·ÙˆÙŠØ± Ù…ÙˆÙ„Ø¯ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ù„Ù…Ù†Ø§Ù‡Ø¬ Ø±ÙŠØ§Ø¶ Ø§Ù„Ø£Ø·ÙØ§Ù„ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©
function generateAssignment(subject: string, grade: string, topic: string, difficulty: string): string {
  const gradeLevel = grade.includes('ØªÙ…Ù‡ÙŠØ¯ÙŠ') || grade.includes('Ø±ÙˆØ¶Ø©') ? 
                    (grade.includes('Ø£ÙˆÙ„') || grade.includes('ØµØºÙŠØ±') ? 'ØµØºÙŠØ±' : 
                     grade.includes('Ø«Ø§Ù†ÙŠ') || grade.includes('Ù…ØªÙˆØ³Ø·') ? 'Ù…ØªÙˆØ³Ø·' : 'ÙƒØ¨ÙŠØ±') : 'Ù…ØªÙˆØ³Ø·';

  // Ù…Ù†Ø§Ù‡Ø¬ Ø±ÙŠØ§Ø¶ Ø§Ù„Ø£Ø·ÙØ§Ù„ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©
  const saudiKindergartenCurriculum = {
    'Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©': {
      'ØµØºÙŠØ±': {
        easy: `Ù†Ø´Ø§Ø· Ù„ØºÙˆÙŠ ÙÙŠ ${topic} - Ø§Ù„Ø±ÙˆØ¶Ø© Ø§Ù„ØµØºÙŠØ±Ø©

ğŸ¯ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©:
â€¢ Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø±ÙˆÙ ÙˆØ§Ù„Ø£ØµÙˆØ§Øª
â€¢ ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª Ø§Ù„Ø¨Ø³ÙŠØ·Ø©
â€¢ ØªÙ†Ù…ÙŠØ© Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹

ğŸ“š Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
1. Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ù‚ØµØ© Ù‚ØµÙŠØ±Ø© Ø¹Ù† ${topic}
2. ØªÙ„ÙˆÙŠÙ† Ø§Ù„Ø­Ø±ÙˆÙ Ø§Ù„Ù…ØªØ¹Ù„Ù‚Ø© Ø¨Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹
3. ØªØ±Ø¯ÙŠØ¯ Ø£ØºÙ†ÙŠØ© ØªØ¹Ù„ÙŠÙ…ÙŠØ©
4. Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ 3 ÙƒÙ„Ù…Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©

ğŸ  Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ù…Ø¹ Ø§Ù„Ø£Ù‡Ù„:
â€¢ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù‚ØµØ© Ù…Ø¹ Ø§Ù„Ø·ÙÙ„ Ù‚Ø¨Ù„ Ø§Ù„Ù†ÙˆÙ…
â€¢ ØªÙƒØ±Ø§Ø± Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù„Ø¹Ø¨`,

        medium: `Ù…Ø´Ø±ÙˆØ¹ Ù„ØºÙˆÙŠ ÙÙŠ ${topic} - Ø§Ù„Ø±ÙˆØ¶Ø© Ø§Ù„ØµØºÙŠØ±Ø©

ğŸ¯ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù:
â€¢ ØªØ·ÙˆÙŠØ± Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ù„ÙØ¸ÙŠ
â€¢ Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
â€¢ ØªØ¹Ø²ÙŠØ² Ø­Ø¨ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©

ğŸ“š Ø§Ù„Ù…Ù‡Ø§Ù…:
1. Ø­ÙØ¸ 3 Ø£Ø¨ÙŠØ§Øª Ø´Ø¹Ø± Ø¨Ø³ÙŠØ·Ø© Ø¹Ù† ${topic}
2. Ø±Ø³Ù… ØµÙˆØ±Ø© ÙˆØªØ³Ù…ÙŠØ© Ø§Ù„Ø£Ø´ÙŠØ§Ø¡ ÙÙŠÙ‡Ø§
3. Ø³Ø±Ø¯ Ù‚ØµØ© Ù‚ØµÙŠØ±Ø© Ø¨Ø§Ù„ØµÙˆØ±
4. Ù„Ø¹Ø¨Ø© Ø§Ù„Ø­Ø±ÙˆÙ ÙˆØ§Ù„ÙƒÙ„Ù…Ø§Øª
5. Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ù…ÙƒØªØ¨Ø© Ù…Ø¹ Ø§Ù„Ø£Ù‡Ù„

ğŸ  Ø§Ù„ØªØ¹Ø§ÙˆÙ† Ø§Ù„Ø£Ø³Ø±ÙŠ:
â€¢ Ù…Ù…Ø§Ø±Ø³Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ© Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
â€¢ Ù‚Ø±Ø§Ø¡Ø© ÙƒØªØ§Ø¨ Ø£Ø·ÙØ§Ù„ Ø£Ø³Ø¨ÙˆØ¹ÙŠØ§Ù‹`,

        hard: `Ø¨Ø±Ù†Ø§Ù…Ø¬ Ù„ØºÙˆÙŠ Ù…ØªÙƒØ§Ù…Ù„ ÙÙŠ ${topic}

ğŸ¯ Ø£Ù‡Ø¯Ø§Ù Ù…ØªÙ‚Ø¯Ù…Ø©:
â€¢ Ø¥ØªÙ‚Ø§Ù† Ù†Ø·Ù‚ Ø§Ù„Ø­Ø±ÙˆÙ ÙˆØªÙ…ÙŠÙŠØ²Ù‡Ø§
â€¢ ØªÙƒÙˆÙŠÙ† Ø¬Ù…Ù„ Ø¨Ø³ÙŠØ·Ø©
â€¢ ÙÙ‡Ù… Ø§Ù„Ù†ØµÙˆØµ Ø§Ù„Ù‚ØµÙŠØ±Ø©

ğŸ“š Ø§Ù„Ø£Ù†Ø´Ø·Ø©:
1. Ø¥Ù†Ø´Ø§Ø¡ ÙƒØªØ§Ø¨ ØµØºÙŠØ± Ø¹Ù† ${topic}
2. ØªÙ…Ø«ÙŠÙ„ Ù‚ØµØ© Ù‚ØµÙŠØ±Ø©
3. ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø­Ø±ÙˆÙ ÙÙŠ Ø§Ù„Ø±Ù…Ù„/Ø§Ù„Ø·Ø­ÙŠÙ†
4. Ù„Ø¹Ø¨Ø© Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ÙƒÙ„Ù…Ø§Øª
5. Ø¥Ø¹Ø¯Ø§Ø¯ Ø¹Ø±Ø¶ ØªÙ‚Ø¯ÙŠÙ…ÙŠ Ø¨Ø³ÙŠØ·

ğŸ  Ø§Ù„Ø´Ø±Ø§ÙƒØ© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©:
â€¢ Ø²ÙŠØ§Ø±Ø© Ø£Ù…Ø§ÙƒÙ† Ù…ØªØ¹Ù„Ù‚Ø© Ø¨Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹
â€¢ ØªØ·Ø¨ÙŠÙ‚ Ù…Ø§ ØªØ¹Ù„Ù… ÙÙŠ Ø§Ù„Ø­ÙŠØ§Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©`
      },
      'Ù…ØªÙˆØ³Ø·': {
        easy: `Ù†Ø´Ø§Ø· Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ÙˆØ§Ù„ÙƒØªØ§Ø¨Ø© - ${topic}

ğŸ¯ Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø±ÙˆØ¶Ø© Ø§Ù„Ù…ØªÙˆØ³Ø·Ø©:
â€¢ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø¨Ø³ÙŠØ·Ø©
â€¢ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø­Ø±ÙˆÙ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
â€¢ ÙÙ‡Ù… Ø§Ù„Ù…Ø¹Ø§Ù†ÙŠ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©

ğŸ“ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨:
1. Ù‚Ø±Ø§Ø¡Ø© 5 ÙƒÙ„Ù…Ø§Øª Ù…ØªØ¹Ù„Ù‚Ø© Ø¨Ù€ ${topic}
2. ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø­Ø±ÙˆÙ Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù…Ù† ÙƒÙ„ ÙƒÙ„Ù…Ø©
3. Ø±Ø³Ù… ØµÙˆØ±Ø© ØªØ¹Ø¨Ø± Ø¹Ù† ÙƒÙ„ ÙƒÙ„Ù…Ø©
4. Ø­ÙØ¸ Ø¯Ø¹Ø§Ø¡ Ø£Ùˆ Ø¢ÙŠØ© Ù‚Ø±Ø¢Ù†ÙŠØ© Ù‚ØµÙŠØ±Ø©

ğŸ  Ø§Ù„ÙˆØ§Ø¬Ø¨ Ø§Ù„Ù…Ù†Ø²Ù„ÙŠ:
â€¢ Ù‚Ø±Ø§Ø¡Ø© ÙŠÙˆÙ…ÙŠØ© 10 Ø¯Ù‚Ø§Ø¦Ù‚
â€¢ ÙƒØªØ§Ø¨Ø© Ø§Ø³Ù… Ø§Ù„Ø·ÙÙ„ 3 Ù…Ø±Ø§Øª ÙŠÙˆÙ…ÙŠØ§Ù‹`,

        medium: `Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© - ${topic}

ğŸ¯ Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©:
â€¢ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¬Ù‡Ø±ÙŠØ© Ø§Ù„Ø¨Ø³ÙŠØ·Ø©
â€¢ Ø§Ù„ÙƒØªØ§Ø¨Ø© Ø§Ù„Ù…Ù†Ù‚ÙˆÙ„Ø©
â€¢ Ø§Ù„ØªØ¹Ø¨ÙŠØ± Ø§Ù„Ø´ÙÙ‡ÙŠ

ğŸ“– Ø§Ù„Ø£Ù†Ø´Ø·Ø©:
1. Ù‚Ø±Ø§Ø¡Ø© Ù‚ØµØ© Ù…Ù† 3 ØµÙØ­Ø§Øª Ø¹Ù† ${topic}
2. Ø¥Ø¹Ø§Ø¯Ø© Ø³Ø±Ø¯ Ø§Ù„Ù‚ØµØ© Ø¨ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø·ÙÙ„
3. ÙƒØªØ§Ø¨Ø© 3 Ø¬Ù…Ù„ Ø¨Ø³ÙŠØ·Ø©
4. Ø±Ø³Ù… Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ù‚ØµØ© Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨
5. ØªØ­Ø¶ÙŠØ± Ø¹Ø±Ø¶ Ù„Ù„ÙØµÙ„

ğŸ  Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø£Ø³Ø±ÙŠØ©:
â€¢ Ù…Ù†Ø§Ù‚Ø´Ø© Ø§Ù„Ù‚ØµØ© Ù…Ø¹ Ø§Ù„Ø·ÙÙ„
â€¢ ØªØ´Ø¬ÙŠØ¹ Ø§Ù„Ø·ÙÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©`,

        hard: `Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ù…ØªÙ‚Ø¯Ù… - ${topic}

ğŸ¯ Ø¥ØªÙ‚Ø§Ù† Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø±ÙˆØ¶Ø©:
â€¢ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø³Ù„ÙŠÙ…Ø© Ù…Ø¹ Ø§Ù„ÙÙ‡Ù…
â€¢ Ø§Ù„ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ÙŠØ© Ø§Ù„Ø¨Ø³ÙŠØ·Ø©
â€¢ Ø§Ù„ØªØ­Ø¯Ø« Ø¨Ø«Ù‚Ø©

ğŸ“š Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ø´Ø§Ù…Ù„:
1. ÙƒØªØ§Ø¨Ø© Ù‚ØµØ© Ù‚ØµÙŠØ±Ø© (5 Ø¬Ù…Ù„) Ø¹Ù† ${topic}
2. Ø¥Ù„Ù‚Ø§Ø¡ Ø§Ù„Ù‚ØµØ© Ø£Ù…Ø§Ù… Ø§Ù„ÙØµÙ„
3. Ø±Ø³Ù… Ø´Ø®ØµÙŠØ§Øª Ø§Ù„Ù‚ØµØ©
4. Ø­ÙØ¸ 5 Ø£Ø¨ÙŠØ§Øª Ø´Ø¹Ø±
5. ØªØ£Ù„ÙŠÙ Ø£ØºÙ†ÙŠØ© Ø¨Ø³ÙŠØ·Ø©

ğŸ  Ø§Ù„Ø¥Ø«Ø±Ø§Ø¡ Ø§Ù„Ù…Ù†Ø²Ù„ÙŠ:
â€¢ Ø¥Ù†Ø´Ø§Ø¡ Ù…ÙƒØªØ¨Ø© ØµØºÙŠØ±Ø© Ù„Ù„Ø·ÙÙ„
â€¢ Ù…Ø´Ø§Ù‡Ø¯Ø© Ø¨Ø±Ø§Ù…Ø¬ ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©`
      }
    },
    'Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª': {
      'ØµØºÙŠØ±': {
        easy: `Ø£Ø³Ø§Ø³ÙŠØ§Øª Ø§Ù„Ø£Ø±Ù‚Ø§Ù… - ${topic}

ğŸ”¢ Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª Ù„Ù„ØµØºØ§Ø±:
â€¢ Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… 1-5
â€¢ Ù…ÙÙ‡ÙˆÙ… Ø§Ù„Ø¹Ø¯ Ø§Ù„Ø¨Ø³ÙŠØ·
â€¢ Ø§Ù„ØªÙ…ÙŠÙŠØ² Ø¨ÙŠÙ† Ø§Ù„Ø£Ø´ÙƒØ§Ù„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©

ğŸ² Ø§Ù„Ø£Ù†Ø´Ø·Ø©:
1. Ø¹Ø¯ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ ÙÙŠ Ø§Ù„ØµÙ (1-5)
2. ØªÙ„ÙˆÙŠÙ† Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙˆØªØªØ¨Ø¹ Ø´ÙƒÙ„Ù‡Ø§
3. ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£Ø´ÙŠØ§Ø¡ Ø­Ø³Ø¨ Ø§Ù„Ø­Ø¬Ù…
4. Ù„Ø¹Ø¨Ø© Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ø±Ù‚Ù… Ø¨Ø§Ù„Ø¹Ø¯Ø¯

ğŸ  Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø© Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ©:
â€¢ Ø¹Ø¯ Ø§Ù„Ø£Ø´ÙŠØ§Ø¡ ÙÙŠ Ø§Ù„Ù…Ù†Ø²Ù„ ÙŠÙˆÙ…ÙŠØ§Ù‹
â€¢ ØºÙ†Ø§Ø¡ Ø£ØºØ§Ù†ÙŠ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…`,

        medium: `Ø§Ø³ØªÙƒØ´Ø§Ù Ø§Ù„Ø£Ø±Ù‚Ø§Ù… - ${topic}

ğŸ”¢ ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…ÙØ§Ù‡ÙŠÙ… Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ©:
â€¢ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ù…Ù† 1-10
â€¢ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¨Ø³ÙŠØ·Ø© (Ø¬Ù…Ø¹ Ø¨ØµØ±ÙŠ)
â€¢ Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø© ÙˆØ§Ù„ØªØ±ØªÙŠØ¨

ğŸ¯ Ø§Ù„Ù…Ù‡Ø§Ù…:
1. Ø¨Ù†Ø§Ø¡ Ø£Ø¨Ø±Ø§Ø¬ Ù…Ù† Ø§Ù„Ù…ÙƒØ¹Ø¨Ø§Øª (1-10)
2. Ù„Ø¹Ø¨Ø© Ø§Ù„Ø¬Ù…Ø¹ Ø¨Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨
3. Ø±Ø³Ù… Ø§Ù„Ø£Ø´ÙƒØ§Ù„ Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠØ©
4. Ù‚ÙŠØ§Ø³ Ø§Ù„Ø£Ø´ÙŠØ§Ø¡ Ø¨ÙˆØ­Ø¯Ø§Øª Ø¨Ø³ÙŠØ·Ø©
5. Ø­Ù„ Ø§Ù„Ø£Ù„ØºØ§Ø² Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ© Ø§Ù„Ù…ØµÙˆØ±Ø©

ğŸ  Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¹Ù…Ù„ÙŠ:
â€¢ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙÙŠ Ø§Ù„Ø·Ø¨Ø®
â€¢ Ø¹Ø¯ Ø§Ù„Ù†Ù‚ÙˆØ¯ Ø§Ù„ÙˆØ±Ù‚ÙŠØ© Ø§Ù„Ø¨Ø³ÙŠØ·Ø©`,

        hard: `Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ÙŠØ© - ${topic}

ğŸ”¢ Ù…Ù‡Ø§Ø±Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø© Ù„Ù„Ø±ÙˆØ¶Ø©:
â€¢ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø­ØªÙ‰ 20
â€¢ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¬Ù…Ø¹ ÙˆØ§Ù„Ø·Ø±Ø­ Ø§Ù„Ø¨Ø³ÙŠØ·Ø©
â€¢ Ø­Ù„ Ø§Ù„Ù…Ø³Ø§Ø¦Ù„ Ø§Ù„Ù„ÙØ¸ÙŠØ©

ğŸ“Š Ø§Ù„Ù…Ø´Ø±ÙˆØ¹:
1. Ø¥Ù†Ø´Ø§Ø¡ Ù…ØªØ¬Ø± ØµØºÙŠØ± ÙˆØ§Ù„Ù„Ø¹Ø¨ Ø¨Ø§Ù„Ù†Ù‚ÙˆØ¯
2. Ù‚ÙŠØ§Ø³ ÙˆØ²Ù† Ø§Ù„Ø£Ø´ÙŠØ§Ø¡ Ø¨Ø§Ù„Ù…ÙŠØ²Ø§Ù†
3. Ø±Ø³Ù… Ø¬Ø¯Ø§ÙˆÙ„ Ø¨Ø³ÙŠØ·Ø©
4. Ø­Ù„ Ù…Ø³Ø§Ø¦Ù„ Ù…Ù† Ø§Ù„Ø­ÙŠØ§Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©
5. ØªØµÙ…ÙŠÙ… Ø£Ø´ÙƒØ§Ù„ Ù‡Ù†Ø¯Ø³ÙŠØ© Ø¨Ø§Ù„Ù…ÙƒØ¹Ø¨Ø§Øª

ğŸ  Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª ÙÙŠ Ø§Ù„Ø¨ÙŠØª:
â€¢ Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø·ÙÙ„ ÙÙŠ Ø§Ù„ØªØ³ÙˆÙ‚ ÙˆØ§Ù„Ø­Ø³Ø§Ø¨
â€¢ Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠ`
      }
    },
    'Ø§Ù„Ø¹Ù„ÙˆÙ…': {
      'ØµØºÙŠØ±': {
        easy: `Ø§ÙƒØªØ´Ø§Ù Ø§Ù„Ø¹Ø§Ù„Ù… - ${topic}

ğŸ”¬ Ø¹Ù„ÙˆÙ… Ø§Ù„Ø·Ø¨ÙŠØ¹Ø© Ù„Ù„ØµØºØ§Ø±:
â€¢ Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø·Ø¨ÙŠØ¹Ø©
â€¢ Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª Ø§Ù„Ø­ÙŠØ©
â€¢ ÙÙ‡Ù… Ø§Ù„Ø¸ÙˆØ§Ù‡Ø± Ø§Ù„Ø¨Ø³ÙŠØ·Ø©

ğŸŒ± Ø§Ù„Ø£Ù†Ø´Ø·Ø©:
1. Ø²Ø±Ø§Ø¹Ø© Ø¨Ø°Ø±Ø© ÙˆÙ…Ø±Ø§Ù‚Ø¨Ø© Ù†Ù…ÙˆÙ‡Ø§
2. Ø±Ø³Ù… Ø§Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª ÙˆØ§Ù„Ù†Ø¨Ø§ØªØ§Øª
3. ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø·ÙÙˆ ÙˆØ§Ù„ØºÙˆØµ
4. Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø·Ù‚Ø³ ÙŠÙˆÙ…ÙŠØ§Ù‹

ğŸ  Ø§Ù„Ø§Ø³ØªÙƒØ´Ø§Ù Ø§Ù„Ù…Ù†Ø²Ù„ÙŠ:
â€¢ Ø¬Ù…Ø¹ Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„Ø´Ø¬Ø± ÙˆØ§Ù„Ø²Ù‡ÙˆØ±
â€¢ Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø­Ø´Ø±Ø§Øª ÙÙŠ Ø§Ù„Ø­Ø¯ÙŠÙ‚Ø©`,

        medium: `Ø¹Ø§Ù„Ù… Ø§Ù„Ø§ÙƒØªØ´Ø§ÙØ§Øª - ${topic}

ğŸ”¬ Ø§Ù„ØªÙÙƒÙŠØ± Ø§Ù„Ø¹Ù„Ù…ÙŠ:
â€¢ Ø·Ø±Ø­ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø¹Ù„Ù…ÙŠØ©
â€¢ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© ÙˆØ§Ù„ØªØ³Ø¬ÙŠÙ„
â€¢ Ø§Ù„ØªØ¬Ø§Ø±Ø¨ Ø§Ù„Ø¨Ø³ÙŠØ·Ø©

ğŸ§ª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ø¹Ù„Ù…ÙŠ:
1. ØªØ¬Ø±Ø¨Ø© Ø®Ù„Ø· Ø§Ù„Ø£Ù„ÙˆØ§Ù†
2. ØµÙ†Ø§Ø¹Ø© Ù‚ÙˆØ³ Ù‚Ø²Ø­ Ø¨Ø§Ù„Ù…Ø§Ø¡
3. Ø²Ø±Ø§Ø¹Ø© Ø­Ø¯ÙŠÙ‚Ø© ØµØºÙŠØ±Ø©
4. Ù…Ø±Ø§Ù‚Ø¨Ø© Ø¯ÙˆØ±Ø© Ø§Ù„Ù…Ø§Ø¡
5. ØªØµÙ†ÙŠÙ Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª Ø§Ù„Ø­ÙŠØ©

ğŸ  Ø§Ù„Ø¹Ù„ÙˆÙ… ÙÙŠ Ø§Ù„Ù…Ù†Ø²Ù„:
â€¢ ØªØ¬Ø§Ø±Ø¨ Ø§Ù„Ù…Ø·Ø¨Ø® Ø§Ù„Ø¢Ù…Ù†Ø©
â€¢ Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù†Ø¬ÙˆÙ… ÙˆØ§Ù„Ù‚Ù…Ø±`,

        hard: `Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„ØµØºÙŠØ± - ${topic}

ğŸ”¬ Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø¹Ù„Ù…ÙŠ Ù„Ù„Ø£Ø·ÙØ§Ù„:
â€¢ Ø¥Ø¬Ø±Ø§Ø¡ ØªØ¬Ø§Ø±Ø¨ Ù…Ù†Ù‡Ø¬ÙŠØ©
â€¢ ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¨Ø§Ù„Ø±Ø³Ù…
â€¢ ØªÙØ³ÙŠØ± Ø§Ù„Ø¸ÙˆØ§Ù‡Ø± Ø¨Ø¨Ø³Ø§Ø·Ø©

ğŸ§¬ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ø´Ø§Ù…Ù„:
1. Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¹Ø±Ø¶ Ø¹Ù„Ù…ÙŠ ØµØºÙŠØ±
2. ØªØ¬Ø§Ø±Ø¨ Ø§Ù„ÙƒØ«Ø§ÙØ© ÙˆØ§Ù„Ø­Ø¬Ù…
3. Ø¨Ù†Ø§Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ù„Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø´Ù…Ø³ÙŠ
4. Ø¯Ø±Ø§Ø³Ø© Ø¯ÙˆØ±Ø© Ø­ÙŠØ§Ø© Ø§Ù„ÙØ±Ø§Ø´Ø©
5. ØªÙ‚Ø¯ÙŠÙ… Ø¹Ø±Ø¶ Ø¹Ù„Ù…ÙŠ Ù„Ù„Ø¹Ø§Ø¦Ù„Ø©

ğŸ  Ù…Ø®ØªØ¨Ø± Ø§Ù„Ù…Ù†Ø²Ù„:
â€¢ Ø¥Ù†Ø´Ø§Ø¡ Ø±ÙƒÙ† Ø¹Ù„Ù…ÙŠ ÙÙŠ Ø§Ù„Ù…Ù†Ø²Ù„
â€¢ Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ù…ØªØ§Ø­Ù Ø§Ù„Ø¹Ù„Ù…ÙŠØ©`
      }
    }
  };

  const curriculum = saudiKindergartenCurriculum[subject as keyof typeof saudiKindergartenCurriculum];
  if (curriculum) {
    const gradeCurriculum = curriculum[gradeLevel as keyof typeof curriculum];
    if (gradeCurriculum && gradeCurriculum[difficulty as keyof typeof gradeCurriculum]) {
      return gradeCurriculum[difficulty as keyof typeof gradeCurriculum];
    }
  }

  // Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù„Ù„Ù…Ù†Ø§Ù‡Ø¬ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©
  return `ÙˆØ§Ø¬Ø¨ Ù…Ù†Ù‡Ø¬ Ø±ÙŠØ§Ø¶ Ø§Ù„Ø£Ø·ÙØ§Ù„ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ - ${subject}
Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹: ${topic}

ğŸ‡¸ğŸ‡¦ ÙˆÙÙ‚Ø§Ù‹ Ù„Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„ØªØ¹Ù„ÙŠÙ… ÙÙŠ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©

ğŸ¯ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©:
â€¢ ØªÙ†Ù…ÙŠØ© Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ø·ÙÙ„ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ
â€¢ Ø±Ø¨Ø· Ø§Ù„ØªØ¹Ù„Ù… Ø¨Ø§Ù„Ø«Ù‚Ø§ÙØ© ÙˆØ§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©
â€¢ ØªØ·ÙˆÙŠØ± Ø´Ø®ØµÙŠØ© Ø§Ù„Ø·ÙÙ„ Ø§Ù„Ù…ØªÙˆØ§Ø²Ù†Ø©

ğŸ“š Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
1. Ù†Ø´Ø§Ø· ØªÙØ§Ø¹Ù„ÙŠ ÙŠØ±Ø¨Ø· ${topic} Ø¨Ø§Ù„Ø¨ÙŠØ¦Ø© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©
2. ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù…Ù„ÙŠ ÙÙŠ Ø§Ù„Ø­ÙŠØ§Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©
3. Ù‚ØµØ© Ø£Ùˆ Ø£ØºÙ†ÙŠØ© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø¨Ø§Ù„Ù„Ù‡Ø¬Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ©
4. Ù†Ø´Ø§Ø· ÙÙ†ÙŠ ÙŠØ¹Ø¨Ø± Ø¹Ù† Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹

ğŸ  Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø£Ø³Ø±ÙŠØ©:
â€¢ ØªÙØ¹ÙŠÙ„ Ø¯ÙˆØ± Ø§Ù„Ø£Ø³Ø±Ø© ÙÙŠ Ø§Ù„ØªØ¹Ù„Ù…
â€¢ Ø±Ø¨Ø· Ø§Ù„Ø¯Ø±Ø³ Ø¨Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ© ÙˆØ§Ù„ÙˆØ·Ù†ÙŠØ©

ğŸ’¡ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù„Ù„Ù…Ø¹Ù„Ù…Ø©:
â€¢ Ù…Ø±Ø§Ø¹Ø§Ø© Ø§Ù„ÙØ±ÙˆÙ‚ Ø§Ù„ÙØ±Ø¯ÙŠØ©
â€¢ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªØ¹Ø²ÙŠØ² Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠ
â€¢ Ø§Ù„ØªÙ†ÙˆÙŠØ¹ ÙÙŠ Ø·Ø±Ù‚ Ø§Ù„ØªØ¯Ø±ÙŠØ³`;
}

serve(async (req) => {
  // Handle CORS preflight requests
  if (req.method === 'OPTIONS') {
    return new Response(null, { headers: corsHeaders });
  }

  try {
    const supabase = createClient(
      Deno.env.get('SUPABASE_URL') ?? '',
      Deno.env.get('SUPABASE_SERVICE_ROLE_KEY') ?? ''
    );

    const { action, ...requestData } = await req.json();
    console.log('AI Request received:', action, requestData);

    if (action === 'analyze_note') {
      const { noteContent, noteType, studentAge } = requestData as AnalyzeNoteRequest;
      
      if (!noteContent || !noteType) {
        return new Response(
          JSON.stringify({ error: 'Missing noteContent or noteType' }),
          { status: 400, headers: { ...corsHeaders, 'Content-Type': 'application/json' } }
        );
      }

      console.log('Analyzing note:', { noteType, studentAge, contentLength: noteContent.length });
      const result = analyzeNote(noteContent, noteType, studentAge);
      console.log('Analysis result generated successfully');
      
      return new Response(
        JSON.stringify(result),
        { status: 200, headers: { ...corsHeaders, 'Content-Type': 'application/json' } }
      );
    }

    if (action === 'generate_assignment') {
      const { subject, grade, topic, difficulty } = requestData as GenerateAssignmentRequest;
      
      if (!subject || !topic) {
        return new Response(
          JSON.stringify({ error: 'Missing required fields: subject and topic' }),
          { status: 400, headers: { ...corsHeaders, 'Content-Type': 'application/json' } }
        );
      }

      console.log('Generating assignment:', { subject, grade, topic, difficulty });
      const assignmentContent = generateAssignment(subject, grade || 'Ø±ÙˆØ¶Ø© Ù…ØªÙˆØ³Ø·', topic, difficulty || 'medium');
      console.log('Assignment generated successfully');
      
      return new Response(
        JSON.stringify({ assignment: assignmentContent }),
        { status: 200, headers: { ...corsHeaders, 'Content-Type': 'application/json' } }
      );
    }

    return new Response(
      JSON.stringify({ error: 'Invalid action. Use "analyze_note" or "generate_assignment"' }),
      { status: 400, headers: { ...corsHeaders, 'Content-Type': 'application/json' } }
    );

  } catch (error) {
    console.error('Error in assignments-ai function:', error);
    return new Response(
      JSON.stringify({ error: 'Internal server error', details: error.message }),
      { status: 500, headers: { ...corsHeaders, 'Content-Type': 'application/json' } }
    );
  }
})